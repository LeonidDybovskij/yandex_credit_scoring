
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Credit scoring &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'credit_scoring';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Credit scoring</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fcredit_scoring.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/credit_scoring.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Credit scoring</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">Data preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filling-gaps-in-the-dataframe">Filling gaps in the dataframe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-duplicates">Removing duplicates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorization">Categorization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#search-for-correlation-between-data-and-credit-debts">Search for correlation between data and credit debts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-between-the-number-of-children-and-the-fact-of-indebtedness">Correlation between the number of children and the fact of indebtedness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-between-marital-status-and-the-fact-of-indebtedness">Correlation between marital status and the fact of indebtedness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-relationship-between-income-level-and-the-fact-of-indebtedness">The relationship between income level and the fact of indebtedness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-relationship-between-the-purpose-of-taking-a-loan-and-the-fact-of-its-repayment">The relationship between the purpose of taking a loan and the fact of its repayment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#possible-causes-of-missing-values-in-data">Possible causes of missing values in data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="credit-scoring">
<h1>Credit scoring<a class="headerlink" href="#credit-scoring" title="Link to this heading">#</a></h1>
<p>The question is whether the marital status and the number of children of the client affects the fact of repayment of the loan on time. The results of the research will be taken into account when building a model of <strong>credit scoring</strong> — a special system that assesses the ability of a potential borrower to repay the loan to the bank.</p>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Link to this heading">#</a></h2>
<p>Input data from the bank — statistics on the solvency of clients.</p>
<ul class="simple">
<li><p>children - number of children in the family</p></li>
<li><p>days_employed - total length of service in days</p></li>
<li><p>dob_years - client’s age in years</p></li>
<li><p>education - client’s education level</p></li>
<li><p>education_id - education level identifier</p></li>
<li><p>family_status - marital status</p></li>
<li><p>family_status_id - family status identifier</p></li>
<li><p>gender - client’s gender</p></li>
<li><p>income_type - type of employment</p></li>
<li><p>debt - whether the client had debts on repayment of loans</p></li>
<li><p>total_income - monthly income</p></li>
<li><p>purpose - purpose of loan</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importing libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sb</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieving data from a file</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/datasets/data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">----&gt; </span><span class="mi">3</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="k">except</span><span class="p">:</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/util/_decorators.py:211,</span> in <span class="ni">deprecate_kwarg.&lt;locals&gt;._deprecate_kwarg.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>         <span class="n">kwargs</span><span class="p">[</span><span class="n">new_arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_arg_value</span>
<span class="ne">--&gt; </span><span class="mi">211</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/util/_decorators.py:331,</span> in <span class="ni">deprecate_nonkeyword_arguments.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">327</span>         <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arguments</span><span class="o">=</span><span class="n">_format_argument_list</span><span class="p">(</span><span class="n">allow_args</span><span class="p">)),</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>         <span class="ne">FutureWarning</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>         <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">331</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/io/parsers/readers.py:950,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, error_bad_lines, warn_bad_lines, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">948</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">950</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/io/parsers/readers.py:605,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">604</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">605</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">607</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1442,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1441</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1442</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1735,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1734</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1735</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1736</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1737</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1738</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1739</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1740</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1741</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1742</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1743</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1744</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1745</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/io/common.py:856,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">854</span> <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">855</span>     <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">856</span>     <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">857</span>         <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span>         <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">859</span>         <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>         <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">861</span>         <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">862</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">863</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">864</span>     <span class="c1"># Binary mode</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;data.csv&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="k">except</span><span class="p">:</span>
<span class="ne">----&gt; </span><span class="mi">5</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/datasets/data.csv&#39;</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/util/_decorators.py:211,</span> in <span class="ni">deprecate_kwarg.&lt;locals&gt;._deprecate_kwarg.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>         <span class="n">kwargs</span><span class="p">[</span><span class="n">new_arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_arg_value</span>
<span class="ne">--&gt; </span><span class="mi">211</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/util/_decorators.py:331,</span> in <span class="ni">deprecate_nonkeyword_arguments.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_allow_args</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">327</span>         <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arguments</span><span class="o">=</span><span class="n">_format_argument_list</span><span class="p">(</span><span class="n">allow_args</span><span class="p">)),</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>         <span class="ne">FutureWarning</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>         <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">331</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/io/parsers/readers.py:950,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, error_bad_lines, warn_bad_lines, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">935</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">936</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">946</span>     <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">},</span>
<span class="g g-Whitespace">    </span><span class="mi">947</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">948</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">950</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/io/parsers/readers.py:605,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">602</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">604</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">605</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">607</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">608</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1442,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1439</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1441</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1442</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1735,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1733</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1734</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1735</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1736</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1737</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1738</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1739</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1740</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1741</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1742</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1743</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1744</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1745</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1746</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~/anaconda3/lib/python3.10/site-packages/pandas/io/common.py:856,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">851</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">852</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">853</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">854</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">855</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">856</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">857</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">859</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">861</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">862</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">863</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">864</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">865</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/datasets/data.csv&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>-8437.673028</td>
      <td>42</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>253875.639453</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>-4024.803754</td>
      <td>36</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>112080.014102</td>
      <td>buying a car</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>-5623.422610</td>
      <td>33</td>
      <td>Secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>145885.952297</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>-4124.747207</td>
      <td>32</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>267628.550329</td>
      <td>additional education</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>340266.072047</td>
      <td>53</td>
      <td>secondary</td>
      <td>1</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>158616.077870</td>
      <td>to perform a wedding</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>-926.185831</td>
      <td>27</td>
      <td>higher</td>
      <td>0</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>M</td>
      <td>partner</td>
      <td>0</td>
      <td>255763.565419</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>-2879.202052</td>
      <td>43</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>240525.971920</td>
      <td>housing transactions</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>-152.779569</td>
      <td>50</td>
      <td>SECONDARY</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>135823.934197</td>
      <td>education</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
      <td>-6929.865299</td>
      <td>35</td>
      <td>HIGHER</td>
      <td>0</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>95856.832424</td>
      <td>to host a wedding</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>-2188.756445</td>
      <td>41</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>144425.938277</td>
      <td>family home purchase</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 21525 entries, 0 to 21524
Data columns (total 12 columns):
 #   Column            Non-Null Count  Dtype  
---  ------            --------------  -----  
 0   children          21525 non-null  int64  
 1   days_employed     19351 non-null  float64
 2   dob_years         21525 non-null  int64  
 3   education         21525 non-null  object 
 4   education_id      21525 non-null  int64  
 5   family_status     21525 non-null  object 
 6   family_status_id  21525 non-null  int64  
 7   gender            21525 non-null  object 
 8   income_type       21525 non-null  object 
 9   debt              21525 non-null  int64  
 10  total_income      19351 non-null  float64
 11  purpose           21525 non-null  object 
dtypes: float64(2), int64(5), object(5)
memory usage: 2.0+ MB
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-preprocessing">
<h2>Data preprocessing<a class="headerlink" href="#data-preprocessing" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The column names correspond to the universal form.</p></li>
<li><p>The nature of fractional numbers in the days_employed and total_income columns is unclear.</p></li>
<li><p>Negative numbers and outliers occur in the <code class="docutils literal notranslate"><span class="pre">days_employed</span></code> column.</p></li>
</ul>
<section id="filling-gaps-in-the-dataframe">
<h3>Filling gaps in the dataframe<a class="headerlink" href="#filling-gaps-in-the-dataframe" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Looking for gaps in the numbers</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>children               0
days_employed       2174
dob_years              0
education              0
education_id           0
family_status          0
family_status_id       0
gender                 0
income_type            0
debt                   0
total_income        2174
purpose                0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p><a id='match'></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_employed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>\
      <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>From which we can conclude that the missing values in the two columns are matched row-wise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gaps</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<p>The income amount is most strongly influenced by employment type, so we can replace the gaps in the income amount with the median value for each type from the <code class="docutils literal notranslate"><span class="pre">income_type</span></code> column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;income_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>employee              11119
partner                5085
pensioner              3856
civil servant          1459
unemployed                2
entrepreneur              2
student                   1
on maternity leave        1
Name: income_type, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2173
169846.427535    1
105864.256244    1
228945.563612    1
72439.940645     1
132641.540844    1
                ..
155107.752145    1
160528.666287    1
160885.050715    1
100180.178296    1
189255.286637    1
Name: total_income, Length: 19351, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filling gaps in income with medians</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;income_type&#39;</span><span class="p">)[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">median</span><span class="p">()))</span> <span class="c1">#  By default, skips NaN when counting</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>children               0
days_employed       2174
dob_years              0
education              0
education_id           0
family_status          0
family_status_id       0
gender                 0
income_type            0
debt                   0
total_income           0
purpose                0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2172
142594.396847    1105
172357.950966     509
118514.486412     414
150447.935283     147
499163.144947       2
                 ... 
160528.666287       1
160885.050715       1
100180.178296       1
135607.236400       1
189255.286637       1
Name: total_income, Length: 19353, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>These are the medians on the top.</p>
<p>Let’s now examine the missing values in days of employment history.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_employed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_employed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_employed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2173
-327.685916       1
 375163.886753    1
-488.619642       1
 361900.083341    1
-4122.460569      1
                 ..
-667.873467       1
-1327.503350      1
-3347.946979      1
-871.839943       1
-3382.113891      1
Name: days_employed, Length: 19351, dtype: int64
-18388.949901     1
-17615.563266     1
-16593.472817     1
-16264.699501     1
-16119.687737     1
                 ..
 401663.850046    1
 401674.466633    1
 401675.093434    1
 401715.811749    1
 401755.400475    1
Name: days_employed, Length: 19351, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Artifacts among the numbers in the <code class="docutils literal notranslate"><span class="pre">days_employed</span></code> column include:</p>
<ul class="simple">
<li><p>negative numbers</p></li>
<li><p>abnormally high numbers (1100 years is steep even for pensioners)</p></li>
</ul>
<p>It is still unclear why the length of service is fractional. I can’t help feeling that the <code class="docutils literal notranslate"><span class="pre">random.random()</span></code> method is involved in the process of obtaining data in the <code class="docutils literal notranslate"><span class="pre">days_employed</span></code> and <code class="docutils literal notranslate"><span class="pre">total_income</span></code> columns.</p>
<p>Let’s change the sign of negative numbers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fixing artifacts in the days_employed column: change signs</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_employed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_employed&#39;</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>253875.639453</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4024.803754</td>
      <td>36</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>112080.014102</td>
      <td>buying a car</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>5623.422610</td>
      <td>33</td>
      <td>Secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>145885.952297</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4124.747207</td>
      <td>32</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>267628.550329</td>
      <td>additional education</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>340266.072047</td>
      <td>53</td>
      <td>secondary</td>
      <td>1</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>158616.077870</td>
      <td>to perform a wedding</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>926.185831</td>
      <td>27</td>
      <td>higher</td>
      <td>0</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>M</td>
      <td>partner</td>
      <td>0</td>
      <td>255763.565419</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>2879.202052</td>
      <td>43</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>240525.971920</td>
      <td>housing transactions</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>152.779569</td>
      <td>50</td>
      <td>SECONDARY</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>135823.934197</td>
      <td>education</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
      <td>6929.865299</td>
      <td>35</td>
      <td>HIGHER</td>
      <td>0</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>95856.832424</td>
      <td>to host a wedding</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>2188.756445</td>
      <td>41</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>144425.938277</td>
      <td>family home purchase</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimating labor histories by employment type by median:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;income_type&#39;</span><span class="p">)[</span><span class="s1">&#39;days_employed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>income_type
civil servant           2689.368353
employee                1574.202821
entrepreneur             520.848083
on maternity leave      3296.759962
partner                 1547.382223
pensioner             365213.306266
student                  578.751554
unemployed            366413.652744
Name: days_employed, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Awe-inspiring numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 1  0  3  2 -1  4 20  5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>291</th>
      <td>-1</td>
      <td>4417.703588</td>
      <td>46</td>
      <td>secondary</td>
      <td>1</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>102816.346412</td>
      <td>specialized education</td>
    </tr>
    <tr>
      <th>705</th>
      <td>-1</td>
      <td>902.084528</td>
      <td>50</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>civil servant</td>
      <td>0</td>
      <td>137882.899271</td>
      <td>buying a car</td>
    </tr>
    <tr>
      <th>742</th>
      <td>-1</td>
      <td>3174.456205</td>
      <td>57</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>64268.044444</td>
      <td>additional education</td>
    </tr>
    <tr>
      <th>800</th>
      <td>-1</td>
      <td>349987.852217</td>
      <td>54</td>
      <td>secondary</td>
      <td>1</td>
      <td>single</td>
      <td>4</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>86293.724153</td>
      <td>additional education</td>
    </tr>
    <tr>
      <th>941</th>
      <td>-1</td>
      <td>NaN</td>
      <td>57</td>
      <td>Secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>118514.486412</td>
      <td>to buy your own car</td>
    </tr>
    <tr>
      <th>1363</th>
      <td>-1</td>
      <td>1195.264956</td>
      <td>55</td>
      <td>SECONDARY</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>69550.699692</td>
      <td>specialized education</td>
    </tr>
    <tr>
      <th>1929</th>
      <td>-1</td>
      <td>1461.303336</td>
      <td>38</td>
      <td>secondary</td>
      <td>1</td>
      <td>single</td>
      <td>4</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>109121.569013</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>2073</th>
      <td>-1</td>
      <td>2539.761232</td>
      <td>42</td>
      <td>secondary</td>
      <td>1</td>
      <td>divorced</td>
      <td>3</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>162638.609373</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>3814</th>
      <td>-1</td>
      <td>3045.290443</td>
      <td>26</td>
      <td>Secondary</td>
      <td>1</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>civil servant</td>
      <td>0</td>
      <td>131892.785435</td>
      <td>to host a wedding</td>
    </tr>
    <tr>
      <th>4201</th>
      <td>-1</td>
      <td>901.101738</td>
      <td>41</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>civil servant</td>
      <td>0</td>
      <td>226375.766751</td>
      <td>own real estate transactions</td>
    </tr>
    <tr>
      <th>4402</th>
      <td>-1</td>
      <td>398001.302888</td>
      <td>64</td>
      <td>SECONDARY</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>163264.062064</td>
      <td>real estate purchase</td>
    </tr>
    <tr>
      <th>4542</th>
      <td>-1</td>
      <td>1811.899756</td>
      <td>32</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>160544.718446</td>
      <td>education</td>
    </tr>
    <tr>
      <th>5272</th>
      <td>-1</td>
      <td>1143.485347</td>
      <td>46</td>
      <td>secondary</td>
      <td>1</td>
      <td>widowed</td>
      <td>2</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>278708.018820</td>
      <td>real estate purchase</td>
    </tr>
    <tr>
      <th>6013</th>
      <td>-1</td>
      <td>1361.258696</td>
      <td>46</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>143008.454914</td>
      <td>building your own real estate</td>
    </tr>
    <tr>
      <th>6385</th>
      <td>-1</td>
      <td>370215.476226</td>
      <td>48</td>
      <td>secondary</td>
      <td>1</td>
      <td>widowed</td>
      <td>2</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>36052.447435</td>
      <td>education</td>
    </tr>
    <tr>
      <th>7190</th>
      <td>-1</td>
      <td>5928.202068</td>
      <td>34</td>
      <td>SECONDARY</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>184315.121979</td>
      <td>buying a car</td>
    </tr>
    <tr>
      <th>7278</th>
      <td>-1</td>
      <td>526.318451</td>
      <td>51</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>146928.769439</td>
      <td>commercial real estate transactions</td>
    </tr>
    <tr>
      <th>7615</th>
      <td>-1</td>
      <td>NaN</td>
      <td>35</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>142594.396847</td>
      <td>education</td>
    </tr>
    <tr>
      <th>7685</th>
      <td>-1</td>
      <td>3237.360455</td>
      <td>53</td>
      <td>secondary</td>
      <td>1</td>
      <td>widowed</td>
      <td>2</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>159676.174958</td>
      <td>construction of residential real estate</td>
    </tr>
    <tr>
      <th>8229</th>
      <td>-1</td>
      <td>1803.441074</td>
      <td>54</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>138809.082930</td>
      <td>real estate purchase</td>
    </tr>
    <tr>
      <th>8251</th>
      <td>-1</td>
      <td>3113.998449</td>
      <td>31</td>
      <td>secondary</td>
      <td>1</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>54412.056005</td>
      <td>own automobile</td>
    </tr>
    <tr>
      <th>8561</th>
      <td>-1</td>
      <td>195.479496</td>
      <td>31</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>145577.881522</td>
      <td>home renovation</td>
    </tr>
    <tr>
      <th>9565</th>
      <td>-1</td>
      <td>2896.629686</td>
      <td>34</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>126754.656529</td>
      <td>real estate transactions</td>
    </tr>
    <tr>
      <th>9574</th>
      <td>-1</td>
      <td>2710.419901</td>
      <td>28</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>civil servant</td>
      <td>0</td>
      <td>303137.161001</td>
      <td>further education</td>
    </tr>
    <tr>
      <th>10177</th>
      <td>-1</td>
      <td>1743.604011</td>
      <td>37</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>310367.509001</td>
      <td>educational attainment</td>
    </tr>
    <tr>
      <th>10365</th>
      <td>-1</td>
      <td>345774.125957</td>
      <td>63</td>
      <td>HIGHER</td>
      <td>0</td>
      <td>widowed</td>
      <td>2</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>170762.751325</td>
      <td>construction of residential real estate</td>
    </tr>
    <tr>
      <th>10918</th>
      <td>-1</td>
      <td>340499.039342</td>
      <td>50</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>pensioner</td>
      <td>0</td>
      <td>170762.773162</td>
      <td>buying your own house</td>
    </tr>
    <tr>
      <th>11109</th>
      <td>-1</td>
      <td>3438.463024</td>
      <td>59</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>219874.012345</td>
      <td>housing transactions</td>
    </tr>
    <tr>
      <th>11268</th>
      <td>-1</td>
      <td>1048.782203</td>
      <td>30</td>
      <td>higher</td>
      <td>0</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>321603.700207</td>
      <td>to buy a car</td>
    </tr>
    <tr>
      <th>11617</th>
      <td>-1</td>
      <td>370.827130</td>
      <td>27</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>164591.260338</td>
      <td>buying a house to rent</td>
    </tr>
    <tr>
      <th>12304</th>
      <td>-1</td>
      <td>8493.101252</td>
      <td>61</td>
      <td>incomplete higher</td>
      <td>2</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>315006.182056</td>
      <td>real estate</td>
    </tr>
    <tr>
      <th>13786</th>
      <td>-1</td>
      <td>NaN</td>
      <td>42</td>
      <td>secondary</td>
      <td>1</td>
      <td>single</td>
      <td>4</td>
      <td>M</td>
      <td>partner</td>
      <td>0</td>
      <td>172357.950966</td>
      <td>automobile</td>
    </tr>
    <tr>
      <th>14357</th>
      <td>-1</td>
      <td>268.337037</td>
      <td>23</td>
      <td>secondary</td>
      <td>1</td>
      <td>divorced</td>
      <td>3</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>92257.579312</td>
      <td>buying residential real estate</td>
    </tr>
    <tr>
      <th>15147</th>
      <td>-1</td>
      <td>9851.184337</td>
      <td>44</td>
      <td>secondary</td>
      <td>1</td>
      <td>divorced</td>
      <td>3</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>110990.810581</td>
      <td>own automobile</td>
    </tr>
    <tr>
      <th>15435</th>
      <td>-1</td>
      <td>3614.220232</td>
      <td>40</td>
      <td>higher</td>
      <td>0</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>98127.537462</td>
      <td>to perform a wedding</td>
    </tr>
    <tr>
      <th>16129</th>
      <td>-1</td>
      <td>457.861760</td>
      <td>33</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>1</td>
      <td>149641.079451</td>
      <td>automobile</td>
    </tr>
    <tr>
      <th>16265</th>
      <td>-1</td>
      <td>2802.218127</td>
      <td>40</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>111984.472021</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>17095</th>
      <td>-1</td>
      <td>2809.693200</td>
      <td>34</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>182543.890127</td>
      <td>to buy a used car</td>
    </tr>
    <tr>
      <th>17429</th>
      <td>-1</td>
      <td>895.379738</td>
      <td>37</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>214814.018780</td>
      <td>housing</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>-1</td>
      <td>4571.957475</td>
      <td>41</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>122105.415823</td>
      <td>own real estate transactions</td>
    </tr>
    <tr>
      <th>18219</th>
      <td>-1</td>
      <td>3575.215641</td>
      <td>33</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>128362.023879</td>
      <td>higher education</td>
    </tr>
    <tr>
      <th>19100</th>
      <td>-1</td>
      <td>617.246968</td>
      <td>38</td>
      <td>secondary</td>
      <td>1</td>
      <td>single</td>
      <td>4</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>122205.497527</td>
      <td>construction of residential real estate</td>
    </tr>
    <tr>
      <th>19366</th>
      <td>-1</td>
      <td>372.034749</td>
      <td>43</td>
      <td>SECONDARY</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>155588.766795</td>
      <td>used car deal</td>
    </tr>
    <tr>
      <th>19417</th>
      <td>-1</td>
      <td>350340.760224</td>
      <td>28</td>
      <td>secondary</td>
      <td>1</td>
      <td>divorced</td>
      <td>3</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>52872.993654</td>
      <td>automobiles</td>
    </tr>
    <tr>
      <th>20393</th>
      <td>-1</td>
      <td>355157.107212</td>
      <td>69</td>
      <td>secondary</td>
      <td>1</td>
      <td>single</td>
      <td>4</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>116521.045858</td>
      <td>real estate transactions</td>
    </tr>
    <tr>
      <th>20717</th>
      <td>-1</td>
      <td>661.822321</td>
      <td>32</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>137405.384917</td>
      <td>buying residential real estate</td>
    </tr>
    <tr>
      <th>21140</th>
      <td>-1</td>
      <td>1422.668059</td>
      <td>44</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>169562.091999</td>
      <td>own real estate transactions</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>606</th>
      <td>20</td>
      <td>880.221113</td>
      <td>21</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>partner</td>
      <td>0</td>
      <td>145334.865002</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>720</th>
      <td>20</td>
      <td>855.595512</td>
      <td>44</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>112998.738649</td>
      <td>real estate purchase</td>
    </tr>
    <tr>
      <th>1074</th>
      <td>20</td>
      <td>3310.411598</td>
      <td>56</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>1</td>
      <td>229518.537004</td>
      <td>educational attainment</td>
    </tr>
    <tr>
      <th>2510</th>
      <td>20</td>
      <td>2714.161249</td>
      <td>59</td>
      <td>higher</td>
      <td>0</td>
      <td>widowed</td>
      <td>2</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>264474.835577</td>
      <td>commercial real estate transactions</td>
    </tr>
    <tr>
      <th>2941</th>
      <td>20</td>
      <td>2161.591519</td>
      <td>0</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>199739.941398</td>
      <td>to buy a car</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21008</th>
      <td>20</td>
      <td>1240.257910</td>
      <td>40</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>1</td>
      <td>133524.010303</td>
      <td>own automobile</td>
    </tr>
    <tr>
      <th>21325</th>
      <td>20</td>
      <td>601.174883</td>
      <td>37</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>102986.065978</td>
      <td>specialized education</td>
    </tr>
    <tr>
      <th>21390</th>
      <td>20</td>
      <td>NaN</td>
      <td>53</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>partner</td>
      <td>0</td>
      <td>172357.950966</td>
      <td>buying residential real estate</td>
    </tr>
    <tr>
      <th>21404</th>
      <td>20</td>
      <td>494.788448</td>
      <td>52</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>partner</td>
      <td>0</td>
      <td>156629.683642</td>
      <td>own real estate transactions</td>
    </tr>
    <tr>
      <th>21491</th>
      <td>20</td>
      <td>173.954460</td>
      <td>27</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>155520.899688</td>
      <td>to buy a used car</td>
    </tr>
  </tbody>
</table>
<p>76 rows × 12 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">20</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 0 3 2 4 5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filling gaps in employment history with medians</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_employed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;income_type&#39;</span><span class="p">)[</span><span class="s1">&#39;days_employed&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">median</span><span class="p">()))</span> <span class="c1"># Skips NaN when counting by default</span>
<span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>children            0
days_employed       0
dob_years           0
education           0
education_id        0
family_status       0
family_status_id    0
gender              0
income_type         0
debt                0
total_income        0
purpose             0
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="removing-duplicates">
<h3>Removing duplicates<a class="headerlink" href="#removing-duplicates" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>54
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>253875</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4024.803754</td>
      <td>36</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>112080</td>
      <td>buying a car</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>5623.422610</td>
      <td>33</td>
      <td>Secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>145885</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4124.747207</td>
      <td>32</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>267628</td>
      <td>additional education</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>340266.072047</td>
      <td>53</td>
      <td>secondary</td>
      <td>1</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>158616</td>
      <td>to perform a wedding</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>926.185831</td>
      <td>27</td>
      <td>higher</td>
      <td>0</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>M</td>
      <td>partner</td>
      <td>0</td>
      <td>255763</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>2879.202052</td>
      <td>43</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>partner</td>
      <td>0</td>
      <td>240525</td>
      <td>housing transactions</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>152.779569</td>
      <td>50</td>
      <td>SECONDARY</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>135823</td>
      <td>education</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
      <td>6929.865299</td>
      <td>35</td>
      <td>HIGHER</td>
      <td>0</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>95856</td>
      <td>to host a wedding</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>2188.756445</td>
      <td>41</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>144425</td>
      <td>family home purchase</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;higher&#39; &#39;secondary&#39; &#39;Secondary&#39; &#39;SECONDARY&#39; &#39;HIGHER&#39; &#39;incomplete higher&#39;
 &#39;primary&#39; &#39;Higher&#39; &#39;INCOMPLETE HIGHER&#39; &#39;Incomplete higher&#39; &#39;PRIMARY&#39;
 &#39;Primary&#39; &#39;Academic degree&#39; &#39;ACADEMIC DEGREE&#39; &#39;academic degree&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;Secondary&#39;</span><span class="p">,</span> <span class="s1">&#39;SECONDARY&#39;</span><span class="p">],</span> <span class="s1">&#39;secondary&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;HIGHER&#39;</span><span class="p">,</span> <span class="s1">&#39;Higher&#39;</span><span class="p">],</span> <span class="s1">&#39;higher&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;Incomplete higher&#39;</span><span class="p">,</span> <span class="s1">&#39;INCOMPLETE HIGHER&#39;</span><span class="p">],</span>\
                                              <span class="s1">&#39;incomplete higher&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;PRIMARY&#39;</span><span class="p">,</span> <span class="s1">&#39;Primary&#39;</span><span class="p">],</span> <span class="s1">&#39;primary&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;Academic degree&#39;</span><span class="p">,</span> <span class="s1">&#39;ACADEMIC DEGREE&#39;</span><span class="p">],</span> <span class="s1">&#39;academic degree&#39;</span><span class="p">)</span>

<span class="c1"># data[&#39;education&#39;] = data[&#39;education&#39;].str.lower() </span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;higher&#39;, &#39;secondary&#39;, &#39;incomplete higher&#39;, &#39;primary&#39;,
       &#39;academic degree&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s make sure that there are no duplicates among the income types</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;income_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;employee&#39; &#39;pensioner&#39; &#39;partner&#39; &#39;civil servant&#39; &#39;unemployed&#39;
 &#39;entrepreneur&#39; &#39;student&#39; &#39;on maternity leave&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 21402 entries, 0 to 21524
Data columns (total 12 columns):
 #   Column            Non-Null Count  Dtype  
---  ------            --------------  -----  
 0   children          21402 non-null  int64  
 1   days_employed     21402 non-null  float64
 2   dob_years         21402 non-null  int64  
 3   education         21402 non-null  object 
 4   education_id      21402 non-null  int64  
 5   family_status     21402 non-null  object 
 6   family_status_id  21402 non-null  int64  
 7   gender            21402 non-null  object 
 8   income_type       21402 non-null  object 
 9   debt              21402 non-null  int64  
 10  total_income      21402 non-null  int64  
 11  purpose           21402 non-null  object 
dtypes: float64(1), int64(6), object(5)
memory usage: 2.1+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>253875</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4024.803754</td>
      <td>36</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>112080</td>
      <td>buying a car</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>5623.422610</td>
      <td>33</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>145885</td>
      <td>buying a house</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4124.747207</td>
      <td>32</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>267628</td>
      <td>additional education</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>340266.072047</td>
      <td>53</td>
      <td>secondary</td>
      <td>1</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>158616</td>
      <td>to perform a wedding</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="categorization">
<h3>Categorization<a class="headerlink" href="#categorization" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">total_income_category</span><span class="p">(</span><span class="n">income</span><span class="p">):</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">income</span> <span class="o">&lt;=</span> <span class="mi">30000</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;E&#39;</span>
    <span class="k">elif</span> <span class="mi">30001</span> <span class="o">&lt;=</span> <span class="n">income</span> <span class="o">&lt;=</span> <span class="mi">50000</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;D&#39;</span>
    <span class="k">elif</span> <span class="mi">50001</span> <span class="o">&lt;=</span> <span class="n">income</span> <span class="o">&lt;=</span> <span class="mi">200000</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;C&#39;</span>
    <span class="k">elif</span> <span class="mi">200001</span> <span class="o">&lt;=</span> <span class="n">income</span> <span class="o">&lt;=</span> <span class="mi">1000000</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;B&#39;</span>
    <span class="k">elif</span> <span class="mi">1000001</span> <span class="o">&lt;=</span> <span class="n">income</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;A&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;income is not a positive integer&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">total_income_category</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
      <th>total_income_category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>253875</td>
      <td>buying a house</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4024.803754</td>
      <td>36</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>112080</td>
      <td>buying a car</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>5623.422610</td>
      <td>33</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>145885</td>
      <td>buying a house</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4124.747207</td>
      <td>32</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>267628</td>
      <td>additional education</td>
      <td>B</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>340266.072047</td>
      <td>53</td>
      <td>secondary</td>
      <td>1</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>158616</td>
      <td>to perform a wedding</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;purpose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;buying a house&#39;, &#39;buying a car&#39;, &#39;additional education&#39;,
       &#39;to perform a wedding&#39;, &#39;housing transactions&#39;, &#39;education&#39;,
       &#39;to host a wedding&#39;, &#39;family home purchase&#39;,
       &#39;real estate purchase&#39;, &#39;buying commercial real estate&#39;,
       &#39;buying residential real estate&#39;, &#39;building your own real estate&#39;,
       &#39;real estate&#39;, &#39;building real estate&#39;, &#39;to buy a used car&#39;,
       &#39;to buy your own car&#39;, &#39;commercial real estate transactions&#39;,
       &#39;construction of residential real estate&#39;, &#39;housing&#39;,
       &#39;own real estate transactions&#39;, &#39;automobiles&#39;,
       &#39;getting an education&#39;, &#39;used car deal&#39;, &#39;educational attainment&#39;,
       &#39;automobile&#39;, &#39;wedding&#39;, &#39;further education&#39;,
       &#39;buying your own house&#39;, &#39;real estate transactions&#39;,
       &#39;getting higher education&#39;, &#39;own automobile&#39;,
       &#39;automobile transaction&#39;, &#39;specialized education&#39;,
       &#39;higher education&#39;, &#39;buying a house to rent&#39;, &#39;to buy a car&#39;,
       &#39;home renovation&#39;, &#39;to pursue higher education&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">categorize_purpose</span><span class="p">(</span><span class="n">purpose</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39; car&#39;</span> <span class="ow">in</span> <span class="n">purpose</span> <span class="ow">or</span> <span class="s1">&#39;automobile&#39;</span> <span class="ow">in</span> <span class="n">purpose</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;car operations&#39;</span>
    <span class="k">elif</span> <span class="s1">&#39;hous&#39;</span> <span class="ow">in</span> <span class="n">purpose</span> <span class="ow">or</span> <span class="s1">&#39;home&#39;</span> <span class="ow">in</span> <span class="n">purpose</span> <span class="ow">or</span> <span class="s1">&#39;estate&#39;</span> <span class="ow">in</span> <span class="n">purpose</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;real estate transactions&#39;</span>
    <span class="k">elif</span> <span class="s1">&#39;wedding&#39;</span> <span class="ow">in</span> <span class="n">purpose</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;wedding organization&#39;</span>
    <span class="k">elif</span> <span class="s1">&#39;education&#39;</span> <span class="ow">in</span> <span class="n">purpose</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;educational attainment&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">purpose</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;unpredictable purpose&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;purpose_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;purpose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">categorize_purpose</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
      <th>total_income_category</th>
      <th>purpose_category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>higher</td>
      <td>0</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>253875</td>
      <td>buying a house</td>
      <td>B</td>
      <td>real estate transactions</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4024.803754</td>
      <td>36</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>F</td>
      <td>employee</td>
      <td>0</td>
      <td>112080</td>
      <td>buying a car</td>
      <td>C</td>
      <td>car operations</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>5623.422610</td>
      <td>33</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>145885</td>
      <td>buying a house</td>
      <td>C</td>
      <td>real estate transactions</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4124.747207</td>
      <td>32</td>
      <td>secondary</td>
      <td>1</td>
      <td>married</td>
      <td>0</td>
      <td>M</td>
      <td>employee</td>
      <td>0</td>
      <td>267628</td>
      <td>additional education</td>
      <td>B</td>
      <td>educational attainment</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>340266.072047</td>
      <td>53</td>
      <td>secondary</td>
      <td>1</td>
      <td>civil marriage</td>
      <td>1</td>
      <td>F</td>
      <td>pensioner</td>
      <td>0</td>
      <td>158616</td>
      <td>to perform a wedding</td>
      <td>C</td>
      <td>wedding organization</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="search-for-correlation-between-data-and-credit-debts">
<h2>Search for correlation between data and credit debts<a class="headerlink" href="#search-for-correlation-between-data-and-credit-debts" title="Link to this heading">#</a></h2>
<p>Let’s check if the <code class="docutils literal notranslate"><span class="pre">debt</span></code> column contains binary values or number of debts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;debt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 1]
</pre></div>
</div>
</div>
</div>
<p>Binary. Now to the correlation.</p>
<section id="correlation-between-the-number-of-children-and-the-fact-of-indebtedness">
<h3>Correlation between the number of children and the fact of indebtedness<a class="headerlink" href="#correlation-between-the-number-of-children-and-the-fact-of-indebtedness" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_by_children</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;children&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;debt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]})</span>
<span class="n">data_by_children</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data_by_children</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">droplevel</span><span class="p">()</span> <span class="c1"># Multi-index is inconvenient here</span>
<span class="n">data_by_children</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>children</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14091</td>
      <td>1063</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4808</td>
      <td>444</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2052</td>
      <td>194</td>
    </tr>
    <tr>
      <th>3</th>
      <td>330</td>
      <td>27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>9</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s find the proportion of people in debt by the number of children.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;%&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_by_children</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          count   sum     ratio    %
children                            
0         14091  1063  0.075438  7.5
1          4808   444  0.092346  9.2
2          2052   194  0.094542  9.5
3           330    27  0.081818  8.2
4            41     4  0.097561  9.8
5             9     0  0.000000  0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;children&#39;</span><span class="p">)[</span><span class="s1">&#39;debt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>children
0    0.075438
1    0.092346
2    0.094542
3    0.081818
4    0.097561
5    0.000000
Name: debt, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sb</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_by_children</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">data_by_children</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">data_by_children</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9d99dfc0a5c0d652cf7d1ea98e4d2f6ff5d0d476272a3f448a8df0184d8fd5d0.png" src="_images/9d99dfc0a5c0d652cf7d1ea98e4d2f6ff5d0d476272a3f448a8df0184d8fd5d0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sb</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_by_children</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6db1e8f162abbc51ef7268796893604e93c2df3b0161213ef095daee2df94d8e.png" src="_images/6db1e8f162abbc51ef7268796893604e93c2df3b0161213ef095daee2df94d8e.png" />
</div>
</div>
<p>At first glance there could be a link (growth of more than 1.5%). The decline among clients with 3 children can be explained by the small sample size (330 people).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;count_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;sum_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data_by_children</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_by_children</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          count   sum     ratio    %  count_ratio  sum_ratio
children                                                    
0         14091  1063  0.075438  7.5     0.660588   0.613741
1          4808   444  0.092346  9.2     0.225400   0.256351
2          2052   194  0.094542  9.5     0.096198   0.112009
3           330    27  0.081818  8.2     0.015470   0.015589
4            41     4  0.097561  9.8     0.001922   0.002309
5             9     0  0.000000  0.0     0.000422   0.000000
</pre></div>
</div>
</div>
</div>
<p>It seems that borrowers without children repay debts more often than clients who have children. Apparently, this has a significant impact on the financial capacity of a potential client.<br />
However, we do not have enough data on some groups of borrowers.</p>
</section>
<section id="correlation-between-marital-status-and-the-fact-of-indebtedness">
<h3>Correlation between marital status and the fact of indebtedness<a class="headerlink" href="#correlation-between-marital-status-and-the-fact-of-indebtedness" title="Link to this heading">#</a></h3>
<p>Following the same steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;family_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;married&#39; &#39;civil marriage&#39; &#39;widowed&#39; &#39;divorced&#39; &#39;single&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_by_status</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;family_status&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;debt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]})</span>

<span class="n">data_by_status</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data_by_status</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">droplevel</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_by_status</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                count  sum
family_status             
civil marriage   4134  385
divorced         1189   84
married         12261  927
single           2796  273
widowed           951   63
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_by_status</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_by_status</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data_by_status</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">data_by_status</span><span class="p">[</span><span class="s1">&#39;%&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">data_by_status</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_by_status</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                count  sum     ratio    %
family_status                            
single           2796  273  0.097639  9.8
civil marriage   4134  385  0.093130  9.3
married         12261  927  0.075606  7.6
divorced         1189   84  0.070648  7.1
widowed           951   63  0.066246  6.6
</pre></div>
</div>
</div>
</div>
<p>The difference in numbers is significant, although I cannot find a logical distinction between <code class="docutils literal notranslate"><span class="pre">married</span></code> and <code class="docutils literal notranslate"><span class="pre">common-law</span> <span class="pre">marriage</span></code> (whereas the numbers do), so in my opinion there may not be a correlation.</p>
<p>Even more contrasting is the difference between unmarried clients and divorced clients: the former repay loans 2.7% less often than the latter, although the difference between these groups is not obvious.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;family_status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Не женат / не замужем&#39;</span><span class="p">][</span><span class="s1">&#39;dob_years&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;family_status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;в разводе&#39;</span><span class="p">][</span><span class="s1">&#39;dob_years&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nan
nan
</pre></div>
</div>
</div>
</div>
<p>The difference in average age is not so big.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;family_status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;женат / замужем&#39;</span><span class="p">)])</span>\
          <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<p>Let’s note that more than a third of clients are married without children.</p>
</section>
<section id="the-relationship-between-income-level-and-the-fact-of-indebtedness">
<h3>The relationship between income level and the fact of indebtedness<a class="headerlink" href="#the-relationship-between-income-level-and-the-fact-of-indebtedness" title="Link to this heading">#</a></h3>
<p>We will look for dependence by income categories.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;children&#39;, &#39;days_employed&#39;, &#39;dob_years&#39;, &#39;education&#39;, &#39;education_id&#39;,
       &#39;family_status&#39;, &#39;family_status_id&#39;, &#39;gender&#39;, &#39;income_type&#39;, &#39;debt&#39;,
       &#39;total_income&#39;, &#39;purpose&#39;, &#39;total_income_category&#39;, &#39;purpose_category&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_by_income</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;total_income_category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;debt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]})</span>

<span class="n">data_by_income</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data_by_income</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">droplevel</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_by_income</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                       count   sum
total_income_category             
A                         25     2
B                       5014   354
C                      15921  1353
D                        349    21
E                         22     2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_by_income</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_by_income</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data_by_income</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">data_by_income</span><span class="p">[</span><span class="s1">&#39;%&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">data_by_income</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_by_income</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                       count   sum     ratio    %
total_income_category                            
E                         22     2  0.090909  9.1
C                      15921  1353  0.084982  8.5
A                         25     2  0.080000  8.0
B                       5014   354  0.070602  7.1
D                        349    21  0.060172  6.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sb</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_by_income</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">data_by_income</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">data_by_income</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8286250afe924dc34b9c948290684ab79885b51a7ce6a110c292549e824e8fb9.png" src="_images/8286250afe924dc34b9c948290684ab79885b51a7ce6a110c292549e824e8fb9.png" />
</div>
</div>
<p>For the outermost categories, there is insufficient data to draw conclusions, but the difference between the 50,001 to 200,000 (8.5%) and 200,001 to 1,000,000 (7.1%) categories is plausible.</p>
</section>
<section id="the-relationship-between-the-purpose-of-taking-a-loan-and-the-fact-of-its-repayment">
<h3>The relationship between the purpose of taking a loan and the fact of its repayment<a class="headerlink" href="#the-relationship-between-the-purpose-of-taking-a-loan-and-the-fact-of-its-repayment" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_by_purpose</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;purpose_category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;debt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]})</span>

<span class="n">data_by_purpose</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data_by_purpose</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">droplevel</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_by_purpose</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                          count  sum
purpose_category                    
car operations             4279  400
educational attainment     3988  369
real estate transactions  10751  780
wedding organization       2313  183
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_by_purpose</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_by_purpose</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data_by_purpose</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">data_by_purpose</span><span class="p">[</span><span class="s1">&#39;%&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">data_by_purpose</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_by_purpose</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                          count  sum     ratio    %
purpose_category                                   
car operations             4279  400  0.093480  9.3
educational attainment     3988  369  0.092528  9.3
wedding organization       2313  183  0.079118  7.9
real estate transactions  10751  780  0.072551  7.3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sb</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_by_purpose</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data_by_purpose</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">data_by_purpose</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1140899fab1680dfad1834063c5eefe15d1a8ce71558679470638e39ae1dac3b.png" src="_images/1140899fab1680dfad1834063c5eefe15d1a8ce71558679470638e39ae1dac3b.png" />
</div>
</div>
<p>There is enough data here to draw conclusions for all categories. For example, loans for real estate transactions or weddings are repaid more often than loans for education or car purchases.</p>
</section>
<section id="possible-causes-of-missing-values-in-data">
<h3>Possible causes of missing values in data<a class="headerlink" href="#possible-causes-of-missing-values-in-data" title="Link to this heading">#</a></h3>
<p>As shown <a class="reference internal" href="#match"><span class="xref myst">previously</span></a>, the gaps in income numbers and the labor history are completely overlapping, from which we can conclude that they are non-random.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gaps</span><span class="p">[</span><span class="s1">&#39;income_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>employee         1105
partner           508
pensioner         413
civil servant     147
entrepreneur        1
Name: income_type, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>As you can see, none of these people described themselves as unemployed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_with_gaps</span> <span class="o">=</span> <span class="n">gaps</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;income_type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;debt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]})</span>

<span class="n">data_with_gaps</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data_with_gaps</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">droplevel</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_with_gaps</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               count  sum
income_type              
civil servant    147    7
employee        1105   98
entrepreneur       1    0
partner          508   30
pensioner        413   35
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_with_gaps</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_with_gaps</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data_with_gaps</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">data_with_gaps</span><span class="p">[</span><span class="s1">&#39;%&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">data_with_gaps</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_with_gaps</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               count  sum     ratio    %
income_type                             
employee        1105   98  0.088688  8.9
pensioner        413   35  0.084746  8.5
partner          508   30  0.059055  5.9
civil servant    147    7  0.047619  4.8
entrepreneur       1    0  0.000000  0.0
</pre></div>
</div>
</div>
</div>
<p>Loan default rates are no higher than average, so it’s unlikely that income is not reported with any hidden intent.</p>
<p>I think these customers just didn’t want to list their place of employment (if that option is allowed by the bank).</p>
<p>According to the probable randomness of these people, the gaps are to be filled by the median value within each income group. The arithmetic mean works worse in this case, because even within a group there can be outliers, and the median is more robust than the mean.</p>
</section>
</section>
<section id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Difference between childless clients and those who do have 1 or 2 children is present: 7.5% non-return vs. 9.2% and 9.5% respectively. There is not enough data to draw conclusions for clients with 3, 4 and 5 children.</p></li>
<li><p>In terms of marital status, low arrears rates for widows/widowers and divorced (6.6% and 7.1%) can be noted. Elsewhere, a logical connection is poorly sought.</p></li>
<li><p>People with incomes between 50,001 and 200,000 repay loans less often (8.5%) than people with incomes between 200,001 and 1,000,000. However, the nature of these <strong>fractional</strong> numbers is not clear to me. Especially for students and pensioners. I would check how the numbers of income and work experience were obtained and calculated.</p></li>
<li><p>A fairly clear picture emerges in terms of the purpose of taking a loan. Car and education loans are repaid less often than wedding and real estate loans (9.3% and 9.3% vs. 7.9% and 7.3%).</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to your Jupyter Book</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">Data preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filling-gaps-in-the-dataframe">Filling gaps in the dataframe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-duplicates">Removing duplicates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorization">Categorization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#search-for-correlation-between-data-and-credit-debts">Search for correlation between data and credit debts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-between-the-number-of-children-and-the-fact-of-indebtedness">Correlation between the number of children and the fact of indebtedness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-between-marital-status-and-the-fact-of-indebtedness">Correlation between marital status and the fact of indebtedness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-relationship-between-income-level-and-the-fact-of-indebtedness">The relationship between income level and the fact of indebtedness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-relationship-between-the-purpose-of-taking-a-loan-and-the-fact-of-its-repayment">The relationship between the purpose of taking a loan and the fact of its repayment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#possible-causes-of-missing-values-in-data">Possible causes of missing values in data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>